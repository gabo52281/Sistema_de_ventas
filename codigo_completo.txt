
----- .\src\App.jsx -----
import React from 'react'
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom'
import { AuthProvider, AuthContext } from './context/AuthContext'
import Login from './pages/Login'
import Dashboard from './pages/Dashboard'
import Productos from './pages/Productos'
import Clientes from './pages/Clientes'
import Facturas from './pages/Facturas'
import AdminPanel from './pages/AdminPanel'
import { UIProvider } from './context/UIContext'
import FacturasList from './pages/FacturasList'
import Home from './pages/Home'
import Empleados from './pages/Empleados'


const PrivateRoute = ({ children, roles = [] }) => {
  const { user } = React.useContext(AuthContext)
  if (!user) return <Navigate to="/login" replace />
  if (roles.length && !roles.includes(user.rol)) return <Navigate to="/dashboard" replace />
  return children
}

const PublicRoute = ({ children }) => {
  const { user } = React.useContext(AuthContext)
  if (user) return <Navigate to="/dashboard" replace />
  return children
}



export default function App() {
  return (
      <UIProvider>
    <AuthProvider>
      <BrowserRouter>
        <Routes>
          <Route path="/login" element={<PublicRoute><Login /></PublicRoute>} />
          <Route path="/" element={<PublicRoute><Home /></PublicRoute>} />
          <Route path="/dashboard" element={<PrivateRoute roles={["admin", "superadmin", "cajero", "vendedor"]}><Dashboard /></PrivateRoute>} />
          <Route path="/empleados" element={<PrivateRoute roles={["admin"]}><Empleados /></PrivateRoute>} />
          <Route path="/productos" element={<PrivateRoute roles={["admin"]}><Productos /></PrivateRoute>} />
          <Route path="/clientes" element={<PrivateRoute roles={["admin","cajero"]}><Clientes /></PrivateRoute>} />
          <Route path="/facturas" element={<PrivateRoute roles={["cajero","vendedor"]}><Facturas /></PrivateRoute>} />
          <Route path="/facturas/ver" element={<PrivateRoute roles={["admin","vendedor","cajero"]}><FacturasList /></PrivateRoute>} />
         <Route path="/admin" element={<PrivateRoute roles={["superadmin",]}><AdminPanel /></PrivateRoute>} />

        </Routes>
      </BrowserRouter>
    </AuthProvider>
    </UIProvider>
  )
}
----- .\src\main.jsx -----
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
)

----- .\src\components\DataTable.jsx -----
import React from 'react'

// DataTable minimal y reutilizable
// Props:
// - columns: [{ key, label, className, render? }]
// - data: array
// - rowKey: string
// - actions: (row) => JSX

const DataTable = ({ columns = [], data = [], rowKey = 'id', actions = null }) => {
  return (
    <div className="bg-white rounded shadow overflow-auto">
      <table className="min-w-full w-full table-fixed text-sm">
        <thead className="bg-gray-100">
          <tr>
            {columns.map(col => (
              <th key={col.key} className={`p-2 ${col.className || 'text-left align-middle'}`}>{col.label}</th>
            ))}
            {actions && <th className="p-2 w-48 text-left align-middle">Acciones</th>}
          </tr>
        </thead>
        <tbody>
          {data.map(row => (
            <tr key={row[rowKey]} className="border-t hover:bg-gray-50">
              {columns.map(col => (
                <td key={col.key} className={`p-2 ${col.cellClass || ''}`}>
                  {col.render ? col.render(row) : row[col.key]}
                </td>
              ))}
              {actions && (
                <td className="p-2">
                  <div className="flex items-center space-x-3">
                    {actions(row)}
                  </div>
                </td>
              )}
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  )
}

export default DataTable

----- .\src\components\Navbar.jsx -----
import React, { useContext } from 'react'
import { Link, useNavigate } from 'react-router-dom'
import { AuthContext } from '../context/AuthContext'
import { UIContext } from '../context/UIContext'
import { Menu } from 'lucide-react'

const Navbar = () => {
  const { user, logout } = useContext(AuthContext)
  const { toggleSidebar } = useContext(UIContext)
  const navigate = useNavigate()

  const handleLogout = () => {
    logout()
    navigate('/login')
  }

  // Texto central basado en el rol
  const getCenterText = () => {
    if (!user) return 'Sistema de Ventas POS e Inventario'

    switch (user.rol) {
      case 'superadmin':
        return 'Panel de Superadministrador'
      case 'admin':
        return 'Panel de Administración'
      case 'cajero':
        return 'Panel de Caja'
      case 'vendedor':
        return 'Panel de Ventas'
      default:
        return 'Sistema de Ventas POS e Inventario'
    }
  }

  return (
    <header className="bg-white shadow-sm border-b">
      <div className="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
        {/* Izquierda */}
        <div className="flex items-center gap-3">
          {user && (
            <button
              onClick={toggleSidebar}
              className="md:hidden p-2 rounded hover:bg-gray-100"
            >
              <Menu className="w-6 h-6 text-gray-700" />
            </button>
          )}
          <h1 className="text-xl font-bold text-blue-600">
            Sistema de Ventas POS e Inventario
          </h1>
        </div>

        {/* Centro */}
        <div className="hidden md:block text-gray-700 text-sm font-medium">
          {getCenterText()}
        </div>

        {/* Derecha */}
        <div className="flex items-center gap-3">
          {user && (
            <div className="text-sm text-gray-600">
              👤 {user.nombre || 'Usuario'}
            </div>
          )}
          {user ? (
            <button
              onClick={handleLogout}
              className="bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition"
            >
              Salir
            </button>
          ) : (
            <Link
              to="/login"
              className="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 transition"
            >
              Entrar
            </Link>
          )}
        </div>
      </div>
    </header>
  )
}

export default Navbar

----- .\src\components\SearchBar.jsx -----
import React from 'react'

const SearchBar = ({ value, onChange, placeholder = "Buscar..." }) => (
  <input
    type="text"
    value={value}
    onChange={(e) => onChange(e.target.value)}
    placeholder={placeholder}
    className="border p-2 rounded w-full mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500"
  />
)

export default SearchBar

----- .\src\components\Sidebar.jsx -----
import React, { useContext } from 'react'
import { NavLink } from 'react-router-dom'
import { AuthContext } from '../context/AuthContext'
import { UIContext } from '../context/UIContext'
import { appRoutes } from '../routes_config'

const Sidebar = () => {
  const { user } = useContext(AuthContext)
  const { sidebarOpen, closeSidebar } = useContext(UIContext)
  if (!user) return null

  const { rol } = user



  return (
    <>
      {/* Fondo semitransparente (solo móvil) */}
      {sidebarOpen && (
        <div
          className="fixed inset-0 bg-black bg-opacity-30 z-40 md:hidden"
          onClick={closeSidebar}
        />
      )}

      {/* Sidebar */}
      <aside
        className={`fixed top-0 left-0 h-full w-64 bg-white border-r z-50 transform transition-transform duration-300 
        ${sidebarOpen ? 'translate-x-0' : '-translate-x-full'} 
        md:translate-x-0 md:static md:block`}
      >
        <nav className="p-4 space-y-2">
          {appRoutes
            .filter((r) => r.roles.includes(rol)) // ← solo las permitidas
            .map((r) => (
              <NavLink
                key={r.path}
                to={r.path}
                onClick={closeSidebar}
                className={({ isActive }) =>
                  isActive
                    ? 'block p-2 rounded bg-blue-50 text-blue-700 font-semibold'
                    : 'block p-2 rounded hover:bg-gray-50'
                }
              >
                {r.label}
              </NavLink>
            ))}
        </nav>
      </aside>
    </>
  )
}

export default Sidebar

----- .\src\context\AuthContext.jsx -----
import React, { createContext, useState, useEffect } from 'react'
import api from '../api/axios'

export const AuthContext = createContext()

export const AuthProvider = ({ children }) => {
  const [user, setUser] = useState(() => {
    const raw = localStorage.getItem('user')
    return raw ? JSON.parse(raw) : null
  })
  const [loading, setLoading] = useState(false)

  useEffect(() => {
    if (user) {
      localStorage.setItem('token', user.token)
      localStorage.setItem('user', JSON.stringify(user))
    } else {
      localStorage.removeItem('token')
      localStorage.removeItem('user')
    }
  }, [user])

  const login = async (email, password) => {
    setLoading(true)
    try {
      const res = await api.post('/auth/login', { email, password })
      // backend expected: { token, rol, id_usuario, id_admin }
      const payload = {
        token: res.data.token,
        rol: res.data.rol,
        id_usuario: res.data.id_usuario || null,
        id_admin: res.data.id_admin || null,
        nombre: res.data.nombre || null
      }
      setUser(payload)
      return payload
    } finally {
      setLoading(false)
    }
  }

  const logout = () => setUser(null)

  return (
    <AuthContext.Provider value={{ user, login, logout, loading }}>
      {children}
    </AuthContext.Provider>
  )
}
----- .\src\context\UIContext.jsx -----
import { createContext, useState } from 'react'

export const UIContext = createContext()

export const UIProvider = ({ children }) => {
  const [sidebarOpen, setSidebarOpen] = useState(false)

  const toggleSidebar = () => setSidebarOpen(!sidebarOpen)
  const closeSidebar = () => setSidebarOpen(false)

  return (
    <UIContext.Provider value={{ sidebarOpen, toggleSidebar, closeSidebar }}>
      {children}
    </UIContext.Provider>
  )
}

----- .\src\layouts\MainLayout.jsx -----
import React from 'react'
import Navbar from '../components/Navbar'
import Sidebar from '../components/Sidebar'

const MainLayout = ({ children }) => {
  return (
    <div className="min-h-screen bg-gray-100 flex flex-col">
  <Navbar />
  <div className="flex flex-1">
    <Sidebar />
    <main className="flex-1 p-6 overflow-auto">{children}</main>
  </div>
  <footer className="text-center text-sm text-gray-500 py-4">
    © {new Date().getFullYear()} Sistema de Ventas
  </footer>
</div>

  )
}
export default MainLayout
----- .\src\pages\AdminPanel.jsx -----
import React, { useEffect, useState } from 'react'
import MainLayout from '../layouts/MainLayout'
import api from '../api/axios'
import SearchBar from '../components/SearchBar'
import DataTable from '../components/DataTable'

const AdminPanel = () => {
  const [admins, setAdmins] = useState([])
  const [nuevo, setNuevo] = useState({
    nombre_negocio: '',
    email_contacto: '',
    nombre_admin: '',
    email_admin: '',
    password_admin: ''
  })
  const [search, setSearch] = useState('')

  const fetchAdmins = async () => {
    try {
      const res = await api.get('/admins')
      setAdmins(res.data)
    } catch (e) {
      console.error(e)
    }
  }
  useEffect(() => { fetchAdmins() }, [])

  const crear = async (e) => {
    e.preventDefault()
    await api.post('/admins/crear', nuevo)
    setNuevo({
      nombre_negocio: '',
      email_contacto: '',
      nombre_admin: '',
      email_admin: '',
      password_admin: ''
    })
    fetchAdmins()
  }

  const adminsFiltrados = admins.filter(a =>
    a.nombre_negocio.toLowerCase().includes(search.toLowerCase()) ||
    a.admin_nombre?.toLowerCase().includes(search.toLowerCase())
  )

  return (
    <MainLayout>
      <div>
        <h1 className="text-2xl font-bold mb-4">Panel del Superadmin</h1>

        <form onSubmit={crear} className="mb-6 grid grid-cols-1 md:grid-cols-2 gap-3">
          <input className="border p-2 rounded" placeholder="Nombre del negocio"
            value={nuevo.nombre_negocio}
            onChange={e => setNuevo({ ...nuevo, nombre_negocio: e.target.value })} />
          <input className="border p-2 rounded" placeholder="Email de contacto del negocio"
            value={nuevo.email_contacto}
            onChange={e => setNuevo({ ...nuevo, email_contacto: e.target.value })} />
          <input className="border p-2 rounded" placeholder="Nombre del administrador"
            value={nuevo.nombre_admin}
            onChange={e => setNuevo({ ...nuevo, nombre_admin: e.target.value })} />
          <input className="border p-2 rounded" placeholder="Email del administrador"
            value={nuevo.email_admin}
            onChange={e => setNuevo({ ...nuevo, email_admin: e.target.value })} />
          <input className="border p-2 rounded" type="password" placeholder="Contraseña del administrador"
            value={nuevo.password_admin}
            onChange={e => setNuevo({ ...nuevo, password_admin: e.target.value })} />
          <button className="bg-green-600 text-white px-4 py-2 rounded col-span-full">Crear negocio y admin</button>
        </form>

        <SearchBar value={search} onChange={setSearch} placeholder="Buscar negocio o admin..." />

        <DataTable
          columns={[
            { key: 'id_admin', label: '#', className: 'w-12 text-left align-middle' },
            { key: 'nombre_negocio', label: 'Negocio', className: 'w-1/3 text-left align-middle' },
            { key: 'email_contacto', label: 'Email contacto', className: 'w-1/4 text-left align-middle' },
            { key: 'admin_nombre', label: 'Administrador', className: 'w-1/4 text-left align-middle' },
            { key: 'admin_email', label: 'Email administrador', className: 'w-48 text-left align-middle' }
          ]}
          data={adminsFiltrados}
          rowKey="id_admin"
        />
      </div>
    </MainLayout>
  )
}
export default AdminPanel

----- .\src\pages\Clientes.jsx -----
import React, { useEffect, useState } from 'react'
import MainLayout from '../layouts/MainLayout'
import api from '../api/axios'
import SearchBar from '../components/SearchBar'
import DataTable from '../components/DataTable'


const Clientes = () => {
  const [clientes, setClientes] = useState([])
  const [nuevo, setNuevo] = useState({ nombre:'', telefono:'', direccion:'' , cedula: ''})

  const fetchClientes = async () => { try { const res = await api.get('/clientes'); setClientes(res.data) } catch (e) { console.error(e) } }
  useEffect(()=>{ fetchClientes() }, [])

  const crear = async (e) => { 
    e.preventDefault(); 
    try {
      await api.post('/clientes/crear', nuevo)
      setNuevo({ nombre:'', telefono:'', direccion:'',cedula: ''})
      fetchClientes()
    } catch (err) {
      console.error('Error crear cliente', err)
      alert(err.response?.data?.error || 'Error al crear cliente')
    }
  }

  const eliminar = async (id) => {
    if (!confirm('Eliminar cliente?')) return
    try {
      await api.delete(`/clientes/${id}`)
      fetchClientes()
    } catch (err) {
      console.error('Error eliminar cliente', err)
      alert(err.response?.data?.error || 'Error al eliminar cliente')
    }
  }
  
  const [search, setSearch] = useState('')
  const clientesFiltrados = clientes.filter(c =>
  c.nombre.toLowerCase().includes(search.toLowerCase()) ||
  c.telefono?.toLowerCase().includes(search.toLowerCase())
)

  return (
    <MainLayout>
      <div>
        <h1 className="text-2xl font-bold mb-4">Registra tus clientes</h1>
        
        <form onSubmit={crear} className="mb-6 grid grid-cols-1 md:grid-cols-2 gap-3">
          <input className="border p-2 rounded" placeholder="Nombre" value={nuevo.nombre} onChange={e=>setNuevo({...nuevo,nombre:e.target.value})} />
          <input className="border p-2 rounded" placeholder="Teléfono" value={nuevo.telefono} onChange={e=>setNuevo({...nuevo,telefono:e.target.value})} />
          <input className="border p-2 rounded" placeholder="Dirección" value={nuevo.direccion} onChange={e=>setNuevo({...nuevo,direccion:e.target.value})} />
          <input className="border p-2 rounded" placeholder="Cédula" value={nuevo.cedula} onChange={e=>setNuevo({...nuevo,cedula:e.target.value})} />
          <button className="bg-blue-600 text-white px-4 py-2 rounded col-span-full">Crear cliente</button>
        </form>

        <h1 className="text-2xl font-bold mb-4">Mis clientes</h1>
        <SearchBar value={search} onChange={setSearch} placeholder="Buscar cliente..." />
        <DataTable
          columns={[
            { key: 'id_cliente', label: '#', className: 'w-12 text-left align-middle' },
            { key: 'nombre', label: 'Nombre', className: 'w-1/3 text-left align-middle' },
            { key: 'cedula', label: 'Cédula', className: 'w-1/4 text-left align-middle' },
            { key: 'telefono', label: 'Teléfono', className: 'w-1/4 text-left align-middle' },
            { key: 'direccion', label: 'Dirección', className: 'w-1/3 text-left align-middle' }
          ]}
          data={clientesFiltrados}
          rowKey="id_cliente"
          actions={(c) => (
            <>
              <button onClick={() => eliminar(c.id_cliente)} className="inline-block bg-red-100 text-red-700 text-sm font-medium px-3 py-1 rounded-full hover:bg-red-200 transition">Eliminar</button>
            </>
          )}
        />
      </div>
    </MainLayout>
  )
}
export default Clientes
----- .\src\pages\Dashboard.jsx -----
import React, { useContext } from 'react'
import MainLayout from '../layouts/MainLayout'
import { AuthContext } from '../context/AuthContext'

const DashboardContent = () => {
  const { user } = useContext(AuthContext)
  return (
    <div>
      <h2 className="text-2xl font-semibold mb-4">Panel Principal</h2>
      {user?.rol === 'superadmin' && (
        <p>Bienvenido Superadmin. Aquí puedes crear administradores y negocios.</p>
      )}
      {user?.rol === 'admin' && (
        <p>Bienvenido Admin. Puedes gestionar productos, clientes y trabajadores.</p>
      )}
      {['cajero','vendedor'].includes(user?.rol) && (
        <p>Bienvenido. Puedes acceder al módulo de facturación.</p>
      )}
    </div>
  )
}

const Dashboard = () => (
  <MainLayout>
    <DashboardContent />
  </MainLayout>
)
export default Dashboard
----- .\src\pages\Empleados.jsx -----
import React, { useEffect, useState } from 'react'
import MainLayout from '../layouts/MainLayout'
import api from '../api/axios'
import SearchBar from '../components/SearchBar'
import DataTable from '../components/DataTable'

const Empleados = () => {
  const [empleados, setEmpleados] = useState([])
  const [nuevo, setNuevo] = useState({ nombre: '', email: '', password: '', rol: 'cajero' })
  const [search, setSearch] = useState('')
  const [error, setError] = useState(null)

  const fetchEmpleados = async () => {
    try {
      const res = await api.get('/users')
      setEmpleados(res.data)
    } catch (e) {
      console.error(e)
    }
  }

  useEffect(() => { fetchEmpleados() }, [])

  const crear = async (e) => {
    e.preventDefault()
    try {
      await api.post('/users/crear', nuevo)
      setNuevo({ nombre: '', email: '', password: '', rol: 'cajero' })
      fetchEmpleados()
    } catch (err) {
      setError(err.response?.data?.error || 'Error al crear empleado')
    }
  }

  const empleadosFiltrados = empleados.filter(e =>
    e.nombre.toLowerCase().includes(search.toLowerCase()) ||
    e.email.toLowerCase().includes(search.toLowerCase())
  )

  return (
    <MainLayout>
      <div>
        <h1 className="text-2xl font-bold mb-4">Empleados</h1>

        {error && <div className="text-red-600 mb-2">{error}</div>}

        <form onSubmit={crear} className="mb-6 grid grid-cols-1 md:grid-cols-2 gap-3">
          <input
            className="border p-2 rounded"
            placeholder="Nombre del empleado"
            value={nuevo.nombre}
            onChange={(e) => setNuevo({ ...nuevo, nombre: e.target.value })}
          />
          <input
            className="border p-2 rounded"
            placeholder="Email del empleado"
            value={nuevo.email}
            onChange={(e) => setNuevo({ ...nuevo, email: e.target.value })}
          />
          <input
            type="password"
            className="border p-2 rounded"
            placeholder="Contraseña"
            value={nuevo.password}
            onChange={(e) => setNuevo({ ...nuevo, password: e.target.value })}
          />
          <select
            className="border p-2 rounded"
            value={nuevo.rol}
            onChange={(e) => setNuevo({ ...nuevo, rol: e.target.value })}
          >
            <option value="cajero">Cajero</option>
            <option value="vendedor">Vendedor</option>
          </select>
          <button className="bg-green-600 text-white px-4 py-2 rounded col-span-full">
            Crear empleado
          </button>
        </form>

        <SearchBar value={search} onChange={setSearch} placeholder="Buscar empleado o email..." />

        <DataTable
          columns={[
            { key: 'id_usuario', label: '#', className: 'w-12 text-left align-middle' },
            { key: 'nombre', label: 'Nombre', className: 'w-1/3 text-left align-middle' },
            { key: 'email', label: 'Email', className: 'w-1/3 text-left align-middle' },
            { key: 'rol', label: 'Rol', className: 'w-24 text-left align-middle' }
          ]}
          data={empleadosFiltrados}
          rowKey="id_usuario"
        />
      </div>
    </MainLayout>
  )
}

export default Empleados

----- .\src\pages\Facturas.jsx -----
import React, { useEffect, useState } from 'react'
import MainLayout from '../layouts/MainLayout'
import api from '../api/axios'

const Facturas = () => {
  const [productos, setProductos] = useState([])
  const [clientes, setClientes] = useState([])
  const [items, setItems] = useState([])
  const [clienteSeleccionado, setClienteSeleccionado] = useState('')
  const [facturaCreada, setFacturaCreada] = useState(null)

  useEffect(()=>{ api.get('/productos').then(r=>setProductos(r.data)); api.get('/clientes').then(r=>setClientes(r.data)) }, [])

  const addItem = () => setItems([...items, { id_producto: productos[0]?.id_producto, cantidad: 1 }])
  const updateItem = (idx, field, value) => { const copy = [...items]; copy[idx][field] = value; setItems(copy) }

  const crearFactura = async (e) => {
    e.preventDefault()
    const payload = {
      productos: items.map(i => ({ id_producto: i.id_producto, cantidad: Number(i.cantidad) })),
      id_cliente: clienteSeleccionado || null
    }
    const res = await api.post('/facturas/crear', payload)
    setFacturaCreada(res.data)
    setItems([])
    setClienteSeleccionado('')
  }

  return (
    <MainLayout>
      <div>
        <h1 className="text-2xl font-bold mb-4">Crear Factura</h1>
        <form onSubmit={crearFactura}>
          <div className="mb-4">
            <label>Cliente (opcional)</label>
            <select className="block w-full border p-2 rounded" value={clienteSeleccionado} onChange={e=>setClienteSeleccionado(e.target.value)}>
              <option value="">Sin cliente</option>
              {clientes.map(c => <option key={c.id_cliente} value={c.id_cliente}>{c.nombre}</option>)}
            </select>
          </div>

          {items.map((it, idx) => (
            <div key={idx} className="flex gap-2 mb-2">
              <select className="flex-1 border p-2 rounded" value={it.id_producto} onChange={e=>updateItem(idx,'id_producto', e.target.value)}>
                {productos.map(p => <option key={p.id_producto} value={p.id_producto}>{p.nombre} — {p.precio}</option>)}
              </select>
              <input className="w-24 border p-2 rounded" type="number" value={it.cantidad} onChange={e=>updateItem(idx,'cantidad', e.target.value)} />
            </div>
          ))}

          <div className="flex gap-2 mb-4">
            <button type="button" onClick={addItem} className="bg-green-600 text-white px-4 py-2 rounded">Añadir producto</button>
            <button type="submit" className="bg-blue-600 text-white px-4 py-2 rounded">Crear factura</button>
          </div>
        </form>

        {facturaCreada && (
          <div className="bg-white p-4 rounded shadow my-4">
            <h2 className="text-xl font-semibold mb-2">Factura #{facturaCreada.id_factura}</h2>
            <p>Total: ${facturaCreada.total}</p>
            <p>Cliente: {facturaCreada.cliente || 'N/A'}</p>
            <p>Fecha: {new Date(facturaCreada.fecha).toLocaleString()}</p>
          </div>
        )}
      </div>
    </MainLayout>
  )
}
export default Facturas
----- .\src\pages\FacturasList.jsx -----
import React, { useEffect, useState } from 'react'
import MainLayout from '../layouts/MainLayout'
import api from '../api/axios'
import SearchBar from '../components/SearchBar'
import DataTable from '../components/DataTable'

const FacturasList = () => {
  const [facturas, setFacturas] = useState([])

  useEffect(() => {
    api.get('/facturas').then(res => setFacturas(res.data))
  }, [])



  const [search, setSearch] = useState('')
  const facturasFiltradas = facturas.filter(f =>
  f.cliente.toLowerCase().includes(search.toLowerCase()) ||
  f.vendedor.toLowerCase().includes(search.toLowerCase())
)


  return (
    <MainLayout>
      <h1 className="text-2xl font-bold mb-4">Listado de Facturas</h1>
      <SearchBar value={search} onChange={setSearch} placeholder="Buscar por cliente o vendedor..." />

      <DataTable
        columns={[
          { key: 'id_factura', label: '#', className: 'w-12 text-left align-middle' },
          { key: 'cliente', label: 'Cliente', className: 'w-1/3 text-left align-middle' },
          { key: 'total', label: 'Total', className: 'w-1/4 text-left align-middle', render: (r) => `$${r.total}` },
          { key: 'fecha', label: 'Fecha', className: 'w-1/3 text-left align-middle', render: (r) => new Date(r.fecha).toLocaleString() }
        ]}
        data={facturasFiltradas}
        rowKey="id_factura"
      />
    </MainLayout>
  )
}
export default FacturasList

----- .\src\pages\Home.jsx -----
import React from "react";
import { Link } from "react-router-dom";

export default function Home() {
  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex flex-col">
      {/* NAVBAR */}
      <header className="flex justify-between items-center px-6 py-4 bg-white shadow">
        <h1 className="text-2xl font-bold text-blue-700">
          Sistema de Ventas POS e Inventario
        </h1>
        <Link
          to="/login"
          className="bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700 transition font-medium"
        >
          Ingresar al sistema
        </Link>
      </header>

      {/* CONTENIDO PRINCIPAL */}
      <main className="flex-1 flex flex-col md:flex-row items-center justify-center gap-30 px-6">
        <div className="max-w-lg text-center md:text-left">
          <h2 className="text-4xl md:text-5xl font-extrabold text-gray-800 mb-6 leading-tight">
            Control total de tus ventas y tu inventario
          </h2>
          <p className="text-gray-600 text-lg mb-8">
            Gestiona tus productos, clientes y facturas desde un solo lugar.
            Nuestro sistema te ofrece rapidez, seguridad y control para tu negocio.
          </p>
          <Link
            to="/login"
            className="inline-block bg-blue-600 text-white px-8 py-3 rounded-lg text-lg hover:bg-blue-700 transition"
          >
            Comenzar ahora
          </Link>
        </div>

        <div className="max-w-md animate-fadeIn">
          <img
            src="https://cdn-icons-png.flaticon.com/512/950/950258.png"
            alt="Ilustración de ventas e inventario"
            className="w-3/4 drop-shadow-xl"
          />
        </div>
      </main>

      <footer className="text-center py-4 text-gray-500 text-sm">
        © {new Date().getFullYear()} Sistema de Ventas POS e Inventario
      </footer>
    </div>
  );
}

----- .\src\pages\Login.jsx -----
import React, { useState, useContext } from 'react'
import { useNavigate } from 'react-router-dom'
import { AuthContext } from '../context/AuthContext'

const Login = () => {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const { login } = useContext(AuthContext)
  const navigate = useNavigate()
  const [error, setError] = useState(null)

  const submit = async (e) => {
    e.preventDefault()
    try {
      await login(email, password)
      navigate('/dashboard')
    } catch (err) {
      setError(err.response?.data?.error || 'Credenciales inválidas')
    }
  }

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50">
      <form 
        onSubmit={submit} 
        className="bg-white p-12 rounded-2xl shadow-lg w-full max-w-sm flex flex-col gap-5 h-[400px]"
      >
        <h2 className="text-2xl font-bold text-center">Iniciar sesión</h2>

        {error && <div className="text-red-600 text-center">{error}</div>}

        <input 
          value={email} 
          onChange={e=>setEmail(e.target.value)} 
          placeholder="Email" 
          className="w-full border p-3 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" 
        />
        <input 
          value={password} 
          onChange={e=>setPassword(e.target.value)} 
          type="password" 
          placeholder="Contraseña" 
          className="w-full border p-3 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" 
        />
        <button className="w-full bg-blue-600 text-white p-3 rounded hover:bg-blue-700 transition">
          Entrar
        </button>
      </form>
    </div>
  )
}
export default Login

----- .\src\pages\Productos.jsx -----
import React, { useEffect, useState, useContext } from 'react'
import MainLayout from '../layouts/MainLayout'
import api from '../api/axios'
import { AuthContext } from '../context/AuthContext'
import SearchBar from '../components/SearchBar'
import DataTable from '../components/DataTable'

const Productos = () => {
  const [productos, setProductos] = useState([])
  const [nuevo, setNuevo] = useState({ nombre: '', precio: '', stock: 0 })
  const [error, setError] = useState(null)
  const [search, setSearch] = useState('')
  const { user } = useContext(AuthContext)

  const fetchProductos = async () => {
    try {
      const res = await api.get('/productos')
      setProductos(res.data)
    } catch (e) {
      console.error(e)
    }
  }
  useEffect(() => { fetchProductos() }, [])

  const crear = async (e) => {
    e.preventDefault()
    try {
      await api.post('/productos/crear', {
        nombre: nuevo.nombre,
        precio: Number(nuevo.precio),
        stock: Number(nuevo.stock)
      })
      setNuevo({ nombre: '', precio: '', stock: 0 })
      fetchProductos()
    } catch (err) {
      setError(err.response?.data?.error || 'Error al crear')
    }
  }

  const eliminar = async (id) => {
    if (!confirm('Eliminar producto?')) return
    await api.delete(`/productos/${id}`)
    fetchProductos()
  }

  const productosFiltrados = productos.filter(p =>
    p.nombre.toLowerCase().includes(search.toLowerCase())
  )

  return (
    <MainLayout>
      <div>
        <h1 className="text-2xl font-bold mb-4">Añade tus productos</h1>
        {error && <div className="text-red-600 mb-2">{error}</div>}


        {(user?.rol === 'admin' || user?.rol === 'superadmin') && (
          <form onSubmit={crear} className="mb-4 flex gap-2">
            <input className="border p-2 rounded" placeholder="Nombre"
              value={nuevo.nombre}
              onChange={e => setNuevo({ ...nuevo, nombre: e.target.value })} />
            <input className="border p-2 rounded" placeholder="Precio"
              value={nuevo.precio}
              onChange={e => setNuevo({ ...nuevo, precio: e.target.value })} />
            <input className="border p-2 rounded" placeholder="Stock"
              value={nuevo.stock}
              onChange={e => setNuevo({ ...nuevo, stock: e.target.value })} />
            <button className="bg-green-600 text-white px-4 rounded">Crear</button>
          </form>
        )}
        <h1 className="text-2xl font-bold mb-4">Productos</h1>

        <SearchBar value={search} onChange={setSearch} placeholder="Buscar producto..." />

        <DataTable
          columns={[
            { key: 'id_producto', label: '#', className: 'w-12 text-left align-middle' },
            { key: 'nombre', label: 'Nombre', className: 'w-1/3 text-left align-middle' },
            { key: 'precio', label: 'Precio', className: 'w-24 text-right align-middle', render: (r) => r.precio },
            { key: 'stock', label: 'Stock', className: 'w-24 text-left align-middle' }
          ]}
          data={productosFiltrados}
          rowKey="id_producto"
          actions={(p) => (
            <>
              <button onClick={() => eliminar(p.id_producto)} className="inline-block bg-red-100 text-red-700 text-sm font-medium px-3 py-1 rounded-full hover:bg-red-200 transition">Eliminar</button>
              <button onClick={() => {
                const cantidad = prompt("¿Cuántas unidades deseas añadir?");
                if (cantidad && !isNaN(cantidad)) {
                  api.put(`/productos/${p.id_producto}/add-stock`, { cantidad: Number(cantidad) })
                    .then(() => fetchProductos())
                    .catch(err => alert(err.response?.data?.error || "Error al añadir stock"));
                }
              }} className="inline-block bg-green-100 text-green-700 text-sm font-medium px-3 py-1 rounded-full hover:bg-green-200 transition">+ Añadir stock</button>
            </>
          )}
        />
      </div>
    </MainLayout>
  )
}
export default Productos
